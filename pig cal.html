<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ماشین حساب جادویی اوبونتو + خوک وکتوری خالص</title>
<style>
  :root {
    --bg: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
    --calc: #1a1a2e;
    --key: #16213e;
    --key-hover: #0f3460;
    --orange: #e94560;
    --orange-hover: #ff5e7d;
    --display: #0f3460;
    --text: #e0e0ff;
  }
  .light {
    --bg: linear-gradient(135deg, #ffecd2, #fcb69f, #ff9a9e);
    --calc: #ffffff;
    --key: #f0f0f0;
    --key-hover: #e0e0e0;
    --orange: #e94560;
    --orange-hover: #ff5e7d;
    --display: #fdfdfd;
    --text: #333;
  }

  * { box-sizing: border-box; }
  body {
    margin: 0;
    height: 100vh;
    background: var(--bg);
    font-family: 'Segoe UI', sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    transition: 0.6s;
  }
  .calculator {
    background: var(--calc);
    width: 390px;
    border-radius: 32px;
    overflow: hidden;
    box-shadow: 0 25px 80px rgba(0,0,0,0.7);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255,255,255,0.1);
  }
  .display {
    background: var(--display);
    height: 160px;
    padding: 30px;
    font-size: 48px;
    font-weight: 200;
    color: var(--text);
    text-align: left;
    direction: ltr;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  .keys {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 16px;
    padding: 24px;
    background: var(--calc);
  }
  button {
    background: var(--key);
    border: none;
    border-radius: 20px;
    font-size: 26px;
    color: var(--text);
    cursor: pointer;
    height: 74px;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 8px 15px rgba(0,0,0,0.3);
  }
  button:hover {
    transform: translateY(-6px) scale(1.05);
    background: var(--key-hover);
    box-shadow: 0 15px 25px rgba(0,0,0,0.4);
  }
  button:active {
    transform: translateY(-2px);
  }
  .orange {
    background: var(--orange) !important;
    color: white;
    font-weight: bold;
  }
  .orange:hover { background: var(--orange-hover) !important; }
  .wide { grid-column: span 2; }

/* خوک جادویی 100% CSS + SVG */
  .pig-container {
    position: fixed;
    bottom: 40px;
    left: 40px;
    cursor: pointer;
    z-index: 100;
  }
  .pig-svg {
    width: 160px;
    filter: drop-shadow(0 10px 30px rgba(0,0,0,0.5));
    animation: float 6s infinite ease-in-out;
  }
  @keyframes float {
    0%,100% { transform: translateY(0) rotate(0deg); }
    50% { transform: translateY(-20px) rotate(5deg); }
  }
  .pig-svg:hover { transform: scale(1.2) rotate(15deg) !important; }

  .speech {
    position: absolute;
    top: -80px;
    left: 50%;
    transform: translateX(-50%);
    background: white;
    color: #e94560;
    padding: 12px 20px;
    border-radius: 50px;
    font-weight: bold;
    font-size: 18px;
    opacity: 0;
    transition: 0.4s;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  }
  .speech::after {
    content: "";
    position: absolute;
    bottom: -12px;
    left: 50%;
    transform: translateX(-50%);
    border: 12px solid transparent;
    border-top-color: white;
  }
</style>
</head>
<body>

<div class="calculator">
  <div class="display" id="display">0</div>
  <div class="keys">
    <button onclick="cls()">C</button>
    <button onclick="del()">⌫</button>
    <button onclick="add('(')">(</button>
    <button onclick="add(')')">)</button>

    <button onclick="add('Math.sin(')">sin</button>
    <button onclick="add('Math.cos(')">cos</button>
    <button onclick="add('**2')">x²</button>
    <button onclick="add('/')">÷</button>

    <button onclick="add('7')">7</button>
    <button onclick="add('8')">8</button>
    <button onclick="add('9')">9</button>
    <button onclick="add('*')">×</button>

    <button onclick="add('4')">4</button>
    <button onclick="add('5')">5</button>
    <button onclick="add('6')">6</button>
    <button onclick="add('-')">-</button>

    <button onclick="add('1')">1</button>
    <button onclick="add('2')">2</button>
    <button onclick="add('3')">3</button>
    <button onclick="add('+')">+</button>

    <button class="wide" onclick="add('0')">0</button>
    <button onclick="add('.')">.</button>
    <button class="orange wide" onclick="calc()">=</button>
  </div>
</div>

<!-- خوک جادویی کاملاً وکتوری -->
<div class="pig-container" id="pigContainer">
  <div class="speech" id="speech"></div>
  <svg viewBox="0 0 200 200" class="pig-svg" id="pig">
    <!-- بدن -->
    <ellipse cx="100" cy="120" rx="70" ry="55" fill="#ffb6c9"/>
    <!-- سر -->
    <circle cx="100" cy="80" r="50" fill="#ffb6c9"/>
    <!-- گوش‌ها -->
    <ellipse cx="70" cy="50" rx="25" ry="35" fill="#ff9ebe" transform="rotate(-30 70 50)"/>
    <ellipse cx="130" cy="50" rx="25" ry="35" fill="#ff9ebe" transform="rotate(30 130 50)"/>
    <!-- بینی -->
    <ellipse cx="100" cy="95" rx="28" ry="20" fill="#ff8fb8"/>
    <circle cx="88" cy="92" r="8" fill="#cc4f7d"/>
    <circle cx="112" cy="92" r="8" fill="#cc4f7d"/>
    <!-- چشم‌ها -->
    <circle cx="80" cy="70" r="12" fill="#000" class="eye"/>
    <circle cx="120" cy="70" r="12" fill="#000" class="eye"/>
    <circle cx="83" cy="68" r="5" fill="#fff"/>
    <circle cx="123" cy="68" r="5" fill="#fff"/>
    <!-- دم فنری -->
    <path d="M150 110 Q170 100 165 85 Q160 70 175 75" stroke="#ffb6c9" stroke-width="14" fill="none" stroke-linecap="round"/>
    <!-- هاله جادویی -->
    <circle cx="100" cy="80" r="65" fill="none" stroke="#ff69b4" stroke-width="8" opacity="0.4">
      <animate attributeName="r" values="60;75;60" dur="4s" repeatCount="indefinite"/>
      <animate attributeName="opacity" values="0.3;0.6;0.3" dur="4s" repeatCount="indefinite"/>
    </circle>
    <!-- ستاره‌های جادویی -->
    <g opacity="0.8">
      <path d="M60 40 L65 55 L50 48 Z" fill="#ffd700">
        <animateTransform attributeName="transform" type="rotate" from="0 65 48" to="360 65 48" dur="6s" repeatCount="indefinite"/>
      </path>
      <path d="M140 40 L145 55 L130 48 Z" fill="#ffd700">
        <animateTransform attributeName="transform" type="rotate" from="0 135 48" to="-360 135 48" dur="7s" repeatCount="indefinite"/>
      </path>
    </g>
  </svg>
</div>

<script>
const display = document.getElementById('display');
const pig = document.getElementById('pig');
const speech = document.getElementById('speech');
let expr = "";

function add(v) {
  expr += v;
  display.textContent = expr || "0";
  pig.style.transform = "translateY(-10px) rotate(10deg)";
  setTimeout(() => pig.style.transform = "", 300);
}

function del() {
  expr = expr.slice(0, -1);
  display.textContent = expr || "0";
}

function cls() {
  expr = "";
  display.textContent = "0";
  say("پاک شد!");
}

function say(text, time = 2000) {
  speech.textContent = text;
  speech.style.opacity = 1;
  setTimeout(() => speech.style.opacity = 0, time);
}

function calc() {
  if (!expr) return;
  let safe = expr
    .replace(/π/g, 'Math.PI')
    .replace(/√/g, 'Math.sqrt')
    .replace(/\^/g, '**');

  try {
    let result = Function('"use strict";return (' + safe + ')')();
    result = Number(result.toFixed(10));
    display.textContent = result;
    expr = result.toString();
    say("عالی بود!");
    pig.style.fill = "#ff9eee";
    setTimeout(() => pig.querySelector('ellipse, circle').setAttribute('fill', '#ffb6c9'), 1000);
  } catch {
    display.textContent = "خطا!";
    say("آخ آخ! دوباره بزن");
    pig.style.transform = "rotate(20deg)";
    pig.querySelectorAll('circle[fill="#ffb6c9"]').forEach(el => el.setAttribute('fill', '#ff5555'));
    setTimeout(() => {
      pig.style.transform = "";
      pig.querySelectorAll('circle, ellipse').forEach(el => el.setAttribute('fill', '#ffb6c9'));
      pig.querySelectorAll('ellipse').forEach(el => el.setAttribute('fill', '#ff9ebe'));
    }, 1500);
  }
}

// کلیک روی خوک = تغییر تم
let light = false;
document.getElementById('pigContainer').onclick = () => {
  light = !light;
  document.body.classList.toggle('light', light);
  say(light ? "روشن شد!" : "شب بخیر!", 2000);
  pig.style.transform = "scale(1.4) rotate(360deg)";
  setTimeout(() => pig.style.transform = "", 800);
};
</script>
</body>
</html>